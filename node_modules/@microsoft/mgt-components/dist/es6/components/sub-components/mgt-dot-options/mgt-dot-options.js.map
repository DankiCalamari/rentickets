{"version":3,"file":"mgt-dot-options.js","sourceRoot":"src/","sources":["components/sub-components/mgt-dot-options/mgt-dot-options.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * -------------------------------------------------------------------------------------------\n * Copyright (c) Microsoft Corporation.  All Rights Reserved.  Licensed under the MIT License.\n * See License in the project root for license information.\n * -------------------------------------------------------------------------------------------\n */\n\nimport { fluentMenu, fluentMenuItem, fluentButton } from '@fluentui/web-components';\nimport { MgtBaseTaskComponent } from '@microsoft/mgt-element';\nimport { html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport { strings } from './strings';\nimport { registerFluentComponents } from '../../../utils/FluentComponents';\nimport { styles } from './mgt-dot-options-css';\nimport { registerComponent } from '@microsoft/mgt-element';\nimport { SvgIcon, getSvg } from '../../../utils/SvgHelper';\n\n/**\n * Defines the event functions passed to the option item.\n */\ntype MenuOptionEventFunction = (e: Event) => void;\n\nexport const registerMgtDotOptionsComponent = () => {\n  registerFluentComponents(fluentMenu, fluentMenuItem, fluentButton);\n  registerComponent('dot-options', MgtDotOptions);\n};\n\n/**\n * Custom Component used to handle an arrow rendering for TaskGroups utilized in the task component.\n *\n * @export MgtDotOptions\n * @class MgtDotOptions\n * @extends {MgtBaseComponent}\n *\n * @cssprop --dot-options-menu-background-color - {Color} The color of the background of the menu.\n * @cssprop --dot-options-menu-shadow-color - {Color} The color of the shadow of the menu.\n * @cssprop --dot-options-menu-item-color - {Color} The color of the menu items.\n * @cssprop --dot-options-menu-item-hover-background-color - {Color} The color of the menu items when hovered.\n */\n\nexport class MgtDotOptions extends MgtBaseTaskComponent {\n  /**\n   * Array of styles to apply to the element. The styles should be defined\n   * user the `css` tag function.\n   */\n  public static get styles() {\n    return styles;\n  }\n\n  /**\n   * Strings for localization\n   *\n   * @readonly\n   * @protected\n   * @memberof MgtDotOptions\n   */\n  protected get strings() {\n    return strings;\n  }\n\n  /**\n   * Determines if header menu is rendered or hidden.\n   *\n   * @type {boolean}\n   * @memberof MgtDotOptions\n   */\n  @property({ type: Boolean }) public open: boolean;\n\n  /**\n   * Menu options to be rendered with an attached MouseEvent handler for expansion of details\n   *\n   * @memberof MgtDotOptions\n   */\n  @property({ type: Object }) public options: Record<string, (e: Event) => void>;\n\n  private readonly _clickHandler = () => (this.open = false);\n\n  public connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('click', this._clickHandler);\n  }\n\n  public disconnectedCallback() {\n    window.removeEventListener('click', this._clickHandler);\n    super.disconnectedCallback();\n  }\n\n  /**\n   * Invoked from the base class render method when the _task is in a completed state.\n   */\n  public readonly renderContent = () => {\n    const menuOptions = Object.keys(this.options);\n    return html`\n      <fluent-button\n        appearance=\"stealth\"\n        aria-label=${this.strings.dotOptionsTitle}\n        aria-expanded=${this.open}\n        @click=${this.onDotClick}\n        @keydown=${this.onDotKeydown}\n        class=\"dot-icon\">${getSvg(SvgIcon.Dot)}</fluent-button>\n      <fluent-menu class=${classMap({ menu: true, open: this.open })} aria-expanded=${this.open} aria-label=${this.strings.dotOptionsTitle}>\n        ${menuOptions.map(opt => this.getMenuOption(opt, this.options[opt]))}\n      </fluent-menu>`;\n  };\n\n  private readonly handleItemClick = (e: MouseEvent, fn: MenuOptionEventFunction) => {\n    e.preventDefault();\n    e.stopPropagation();\n    fn(e);\n    this.open = false;\n  };\n\n  private readonly handleItemKeydown = (e: KeyboardEvent, fn: MenuOptionEventFunction) => {\n    this.handleKeydownMenuOption(e);\n    fn(e);\n    this.open = false;\n  };\n\n  /**\n   * Used by the render method to attach click handler to each dot item\n   *\n   * @param {string} name\n   * @param {MenuOptionEventFunction} clickFn\n   * @returns\n   * @memberof MgtDotOptions\n   */\n  public getMenuOption(name: string, clickFn: (e: Event) => void) {\n    return html`\n      <fluent-menu-item\n        @click=${(e: MouseEvent) => this.handleItemClick(e, clickFn)}\n        @keydown=${(e: KeyboardEvent) => this.handleItemKeydown(e, clickFn)}>\n          ${name}\n      </fluent-menu-item>`;\n  }\n\n  private readonly onDotClick = (e: MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.open = !this.open;\n  };\n\n  private readonly onDotKeydown = (e: KeyboardEvent) => {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n\n      this.open = !this.open;\n    }\n  };\n\n  private handleKeydownMenuOption(e: KeyboardEvent) {\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      e.stopPropagation();\n    }\n  }\n}\n"]}